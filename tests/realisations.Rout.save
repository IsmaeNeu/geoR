
R : Copyright 2002, The R Development Core Team
Version 1.5.1 Patched (2002-07-17)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> require(geoR)
Loading required package: geoR 

------------------------------------------------
geoR - functions for geostatistical analysis
geoR version 1.3-5 is now loaded
------------------------------------------------

[1] TRUE
> options(digits = 3, width = 80)
> set.seed(18)
> ##
> ## Examples and test for the function likfit
> ## using the options for realisations
> ##
> ##
> ## Simulating 3 data-set at the same locations
> ##
> ap1 <- grf(40, cov.pars=c(3, .25))
grf: process with  1  covariance structure(s)
grf: nugget effect is: tausq= 0 
grf: covariance model 1 is: exponential(sigmasq=3, phi=0.25)
grf: decomposition algorithm used is:  cholesky 
grf: simulation(s) on randomly chosen locations with  40  points
Loading required package: mva 
grf: End of simulation procedure. Number of realizations: 1 
> ap2 <- grf(grid=ap1$coords, cov.pars=c(3, .25))
grf: process with  1  covariance structure(s)
grf: nugget effect is: tausq= 0 
grf: covariance model 1 is: exponential(sigmasq=3, phi=0.25)
grf: decomposition algorithm used is:  cholesky 
grf: simulation on locations provided by the user
grf: End of simulation procedure. Number of realizations: 1 
> ap3 <- grf(grid=ap1$coords, cov.pars=c(3, .25))
grf: process with  1  covariance structure(s)
grf: nugget effect is: tausq= 0 
grf: covariance model 1 is: exponential(sigmasq=3, phi=0.25)
grf: decomposition algorithm used is:  cholesky 
grf: simulation on locations provided by the user
grf: End of simulation procedure. Number of realizations: 1 
> ##
> ## Pooling together the 3 simulations
> ##
> sim01 <- list(coords=rbind(ap1$coords,ap2$coords,ap3$coords), data=c(ap1$data,ap2$data,ap3$data),realisation=rep(1:3,rep(40,3)))
> ##
> ## estimating parameters of for each relisation
> ##
> ap1.ml <- likfit(ap1, ini=c(3,1))
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
         arguments for the maximisation function.
        For further details see documentation for optim.
likfit: It is highly advisable to run this function several
        times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
> ap2.ml <- likfit(ap2, ini=c(3,1))
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
         arguments for the maximisation function.
        For further details see documentation for optim.
likfit: It is highly advisable to run this function several
        times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
> ap3.ml <- likfit(ap3, ini=c(3,1))
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
         arguments for the maximisation function.
        For further details see documentation for optim.
likfit: It is highly advisable to run this function several
        times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
> ap1.ml
likfit: estimated model parameters:
   beta   tausq sigmasq     phi 
 -0.141   0.020  11.005   0.999 

likfit: maximised log-likelihood = -62.5
> ap2.ml
likfit: estimated model parameters:
   beta   tausq sigmasq     phi 
 -0.862   0.000   2.852   0.141 

likfit: maximised log-likelihood = -64.7
> ap3.ml
likfit: estimated model parameters:
   beta   tausq sigmasq     phi 
 -0.426   0.012  13.248   1.000 

likfit: maximised log-likelihood = -65.7
> ##
> ## estimating parameters for the pooled data
> ##
> sim01.ml <- likfit(sim01, ini=c(3,1), reali = sim01$real)
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
         arguments for the maximisation function.
        For further details see documentation for optim.
likfit: It is highly advisable to run this function several
        times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
> ##
> ## Changing the order of the coordinates
> ##
> ind1 <- sample(1:40)
> ind2 <- sample(1:40)
> ind3 <- sample(1:40)
> sim02 <- list(coords=rbind(ap1$coords[ind1,],ap2$coords[ind2,],ap3$coords[ind3,]), data=c(ap1$data[ind1],ap2$data[ind2],ap3$data[ind3]),realisation=rep(1:3,rep(40,3)))
> sim02.ml <- likfit(sim02, ini=c(3,1), reali = sim02$real)
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
         arguments for the maximisation function.
        For further details see documentation for optim.
likfit: It is highly advisable to run this function several
        times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
> sim01.ml
likfit: estimated model parameters:
   beta   tausq sigmasq     phi 
 -0.261   0.004  13.448   1.000 

likfit: maximised log-likelihood = -196
> sim02.ml
likfit: estimated model parameters:
   beta   tausq sigmasq     phi 
 -0.261   0.004  13.448   1.000 

likfit: maximised log-likelihood = -196
> ##
> ## Now a simulation where the different realisations have
> ## partially different locations 
> ##
> ind1 <- sample(1:40, 30)
> ind2 <- sample(1:40, 20)
> ind3 <- sample(1:40, 25)
> sim03 <- list(coords=rbind(ap1$coords[ind1,],ap2$coords[ind2,],ap3$coords[ind3,]), data=c(ap1$data[ind1],ap2$data[ind2],ap3$data[ind3]),realisation=rep(1:3,c(30, 20, 25)))
> sim03.ml <- likfit(sim03, ini=c(3,1), reali = sim03$real)
---------------------------------------------------------------
likfit: likelihood maximisation using the function optim.
likfit: Use control() to pass additional
         arguments for the maximisation function.
        For further details see documentation for optim.
likfit: It is highly advisable to run this function several
        times with different initial values for the parameters.
likfit: WARNING: This step can be time demanding!
---------------------------------------------------------------
likfit: end of numerical maximisation.
> sim03.ml
likfit: estimated model parameters:
   beta   tausq sigmasq     phi 
 -0.639   0.016  11.948   1.000 

likfit: maximised log-likelihood = -130
> ##
> 
